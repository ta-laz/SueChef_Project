@using System.Diagnostics.Eventing.Reader
<!-- VIEW FOR ALL FAVOURITES -->

@model SueChef.ViewModels.FavouritesPageViewModel

<div class="justify-center p-3">

    <!-- Main central container -->
    <div class="w-full max-w-4xl mx-auto">

        @* Success Message for Removing Recipe from Favourites *@
        <section>
            @if (TempData["Success"] != null)
            {
                <div
                    class="alert-message flex items-center justify-center bg-green-100 border-l-4 border-green-600 text-green-800 p-2 rounded-md shadow mb-6">
                    <svg class="w-8 h-8 mr-2 text-green-600" fill="none" stroke="currentColor" stroke-width="2"
                        viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
                    </svg>
                    <span class="font-medium">@TempData["DeletedRecipeName"] @TempData["Success"]</span>
                    @if (TempData["DeletedRecipeId"] != null)
                    {
                        <a asp-action="UndoDeleteFavourite" asp-route-id="@TempData["DeletedRecipeId"]" class="alert-link">
                            <button
                                class="bg-orange-600 text-white text-sm font-medium w-20 px-3 py-1 rounded-md hover:bg-orange-400 m-2">
                                Undo
                            </button>
                        </a>
                    }
                </div>
            }

            @if (TempData["ErrorMessage"] != null)
            {
                <div class="alert alert-message bg-red-50 border border-red-400 text-red-700 rounded p-3 mb-4 text-sm">
                    @TempData["ErrorMessage"]
                </div>
            }
        </section>

        <section class="mb-8">

            <div
                class=" items-center flex flex-col items-center justify-center w-full mb-6 mt-6 p-2 bg-orange-50  rounded-md">
                <h2 class="text-4xl tracking-tight text-gray-800" data-testid="meal-plans-page-title">Favourites</h2>
                @{
                    string mealPlanCountText = $"{Model.Favourites.Count()} Recipe{(Model.Favourites.Count() != 1 ? "s" : "")}";
                }
                <p class="text-gray-600 text-lg" data-testid="number-of-meal-plans">@mealPlanCountText</p>
            </div>

            <div class="mb-2 flex">
                        <a asp-controller="Home" asp-action="Index"class="flex items-center justify-center w-9 h-9 rounded-full bg-orange-700 hover:bg-orange-600 transition shadow-sm mr-5">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-white" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                            <path d="M12 3.172l8 6.364V20a1 1 0 0 1-1 1h-5v-6H10v6H5a1 1 0 0 1-1-1V9.536l8-6.364z"/>
                        </svg>
                        </a>
                <h2 class="inline text-2xl font-semibold text-gray-800 mb-4 trackling-tight">Your Favourite Recipes: (@Model.Favourites.Count())</h2>
            </div>

            @if(Model.Favourites == null || !Model.Favourites.Any())
            {
                    <div class="bg-white backdrop-blur-sm border border-orange-300 rounded-xl shadow-lg hover:shadow-xl transition-shadow p-6 mt-4">
                <div class="flex items-center mb-3 border-b">
                    <h2 class="text-2xl sm:text-3xl font-bold text-orange-700 pb-2">No Favourites Yet!</h2>
                </div>
                <p class="text-gray-700 mb-3 text-left">Show Sue how much you care by browsing her collection and finding your favourite recipes.</p>
                <div class="flex justify-center">
                    <a asp-controller="Home" asp-action="Index"class="bg-orange-700 hover:bg-orange-600 text-white font-medium px-6 py-2 rounded-full transition duration-300 ease-in-out">Back to Home</a>
                </div>
            </div>
            }
            else 
            { 


            <!-- Each recipe card: -->
                @foreach (var recipe in Model.Favourites)
                {
                    <partial name="_FavouritesRecipeCardPartial" model="recipe" />
                }

            }
        </section>
        
    </div>
</div>