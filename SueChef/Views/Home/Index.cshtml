@using SueChef.Models
@using SueChef.Controllers
@{
    ViewData["Title"] = "Home Page";
}

<!-- Defines the Model variable and what type it should be -->
@model IEnumerable<SueChef.ViewModels.RecipeCardViewModel>

<body class="bg-orange-50">

    <section class="mb-8">
        <h2 class="text-2xl text-center font-semibold mb-4">Batch cooking winners</h2>
        @{
            var verticalRecipes = Model;
        }

        <div class="relative max-w-6xl mx-auto">

            <!-- Left Button (&#8592 is the left arrow symbol) -->
            <button type="button" id="carousel-left"
                class="absolute left-0 top-1/2 -translate-y-1/2 bg-orange-100 hover:bg-orange-300 text-gray-700 rounded-full p-3 z-10 shadow-md">
                &#8592;
            </button>

            <!-- Carousel Track -->
            <div id="carousel-track"
                class="flex overflow-x-auto scroll-smooth snap-x snap-mandatory transition-all duration-500 gap-3 justify-center hide-scrollbar">
                @foreach (var recipe in verticalRecipes)
                {
                    <partial name="_RecipeCardVerticalPartial" model="recipe" />
                }
            </div>

            <!-- Right Button (&#8594 is the right arrow symbol) -->
            <button type="button" id="carousel-right"
                class="absolute right-0 top-1/2 -translate-y-1/2 bg-orange-100 hover:bg-orange-300 text-gray-700 rounded-full p-3 z-10 shadow-md">&#8594;
            </button>
        </div>
    </section>

    <!-- Hide scrollbar utility -->
    <style>
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>

    <section class="mb-8">
        <h2 class="text-2xl text-center font-bold mb-4">Trending now</h2>
        @{
            var horizontalRecipes = Model.Skip(5).Take(5);
        }

        @foreach (var recipe in horizontalRecipes)
        {
            <partial name="_RecipeCardHorizontalPartial" model="recipe" />
        }
    </section>

    <!-- JS for carousel buttons -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const track = document.getElementById("carousel-track");
            const btnLeft = document.getElementById("carousel-left");
            const btnRight = document.getElementById("carousel-right");

            function getVisibleCards() {
                if (window.innerWidth < 640) return 1;
                if (window.innerWidth < 1024) return 2;
                return 4;
            }

            function getCardWidth() {
                const card = track.querySelector(".carousel-card");
                return card ? card.offsetWidth + 12 : 0; // add small gap
            }

            function scrollCarousel(direction) {
                const cardWidth = getCardWidth();
                const visibleCards = getVisibleCards();
                const scrollAmount = cardWidth * visibleCards;
                track.scrollBy({ left: direction * scrollAmount, behavior: "smooth" });
            }

            btnRight.addEventListener("click", () => scrollCarousel(1));
            btnLeft.addEventListener("click", () => scrollCarousel(-1));

            window.addEventListener("resize", () => {
                // Optional: snap realignment on resize
                track.scrollTo({ left: 0, behavior: "smooth" });
            });
        });
    </script>


</body>